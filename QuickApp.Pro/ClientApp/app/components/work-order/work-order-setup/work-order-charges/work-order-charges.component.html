<div *ngIf="!isView && !isQuote">
  <button
    data-target="#addNewCharges"
    data-toggle="modal"
    (click)="createNew()"
    class="btn btn-primary btn-primary"
    style="padding: 6px 12px !important;"
  >
    Add Charges
  </button>
</div>

<div id="addNewCharges" class="modal fade" role="dialog" data-backdrop="static">
  <div class="modal-dialog modal-lg">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          &times;
        </button>
        <h4 class="modal-title">Charges</h4>
      </div>
      <div class="modal-body">
        <grd-charges
          *ngIf="!isEdit"
          [workFlow]="workFlowObject"
          [isWorkOrder]="isWorkOrder"
          [isQuote]="isQuote"
          [markupList]="markupList"
          [taskList]="taskList"
          (saveChargesListForWO)="saveChargesList($event)"
        ></grd-charges>

        <grd-charges
          *ngIf="isEdit && editData"
          [isEdit]="isEdit"
          [editData]="editData"
          [workFlow]="workFlowObject"
          [isWorkOrder]="isWorkOrder"
          [markupList]="markupList"
          [isQuote]="isQuote"
          [taskList]="taskList"
          (updateChargesListForWO)="updateChargesList($event)"
        ></grd-charges>
      </div>
      <div class="modal-footer" *ngIf="!isQuote">
        <button type="button" class="btn btn-danger" data-dismiss="modal">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<div>
  <p-table
    class="rpo-table-cstm rro-table-cstm pub-ptable-cstm"
    [columns]="cols"
    [value]="workOrderChargesList"
    [paginator]="true"
    [rows]="10"
  >
    <ng-template pTemplate="header" let-columns>
        <tr style="color: #f1f1f1;" *ngIf="isQuote">
          <th colspan="7" style="width: 500px;">&nbsp;</th>
          <th colspan="6">
              <!-- <div class="form-group" style="text-align: center;">
                <p-radioButton
                  class="p-radiobutton-label-horizontal p-radio-custom"
                  name="costPlusType"
                  label="T&M"
                  value="Mark Up"
                  [(ngModel)]="costPlusType"
                  [disabled]="isView"
                ></p-radioButton>
                <div style="display: flex;">
                  <label style="color: #ffffff;">Mat Mark Up %</label>
                  <select class="form-control wf-pub-id" (change)="markupChanged({}, 'all')" [(ngModel)]="overAllMarkup" [disabled]="isView || costPlusType != 'Mark Up'">
                    <option value="">Select</option>
                    <option *ngFor="let markUp of markupList" [value]="markUp.value">{{markUp.label}}</option>
                  </select>
                </div>
              </div> -->


              <div class="form-group" style="text-align: center; display: flex;">
                <p-radioButton
                  class="p-radiobutton-label-horizontal p-radio-custom"
                  name="costPlusType"
                  label="T&M - Mark Up"
                  value=1
                  [(ngModel)]="costPlusType"
                  [disabled]="isView"
                  (click)="tmchange()"
                ></p-radioButton>
                <div>
                  <select class="form-group" (change)="markupChanged({}, 'all')" [(ngModel)]="overAllMarkup" [disabled]="isView || costPlusType != 1" style="margin-top: 10px;">
                    <option value="">Select</option>
                    <option *ngFor="let markUp of markupList" [value]="markUp.value">{{markUp.label}}</option>
                  </select>
                </div>
              </div>
              <div style="float: left;">
                <p-radioButton
                  class="p-radiobutton-label-horizontal col-width p-radio-custom"
                  name="costPlusType"
                  value=2
                  label="Actual"
                  [(ngModel)]="costPlusType"
                  [disabled]="isView"
                  (click)="tmchange()"
                ></p-radioButton>
              </div>
          </th>
      </tr>
      <tr>
        <ng-container *ngIf="isQuote">
          <th>Task</th>
        </ng-container>
        <th *ngFor="let col of columns" >
          {{ col.header }}
        </th>
        <ng-container *ngIf="isQuote">
          <th>Billing Method</th>
          <th>Mark Up</th>
          <!-- <th tooltip="Time & Materials">T&M Amount</th>
          <th>Flate Rate</th> -->
          <th>
            Billing Rate
          </th>
          <th>
            Billing Amount
          </th>
        </ng-container>
        <th colspan="2">Action</th>
        <!-- <th colspan="4" class="text-center" *ngIf="!isView"></th> -->
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rowData let-columns="columns">
      <tr *ngIf="!rowData['isDeleted']">
        <ng-container *ngIf="isQuote">
          <td>
            <select class="form-control select-read-only" [(ngModel)]="rowData.taskId"disabled>
              <option value="">Select</option>
              <option *ngFor="let task of taskList" [value]="task.taskId">{{task.description}}</option>
            </select>
          </td>
        </ng-container>
        <td *ngFor="let col of columns">
          {{ rowData[col.field] }}
        </td>
        <ng-container *ngIf="isQuote">
          <td>
            <select class="form-control" [(ngModel)]="rowData.billingMethodId">
              <option value="">Select</option>
              <option *ngFor="let bm of [{'label': 'T&M', 'value': 1}, {'label': 'Actual', 'value': 2}]" [value]="bm.value">{{bm.label}}</option>
            </select>
          </td>
          <td>
            <select
              class="form-control"
              (change)="markupChanged(rowData, 'row')"
              [(ngModel)]="rowData.markupPercentageId"
              [disabled]="isView || rowData.billingMethodId != 1"
            >
              <option value="">Select</option>
              <option
                *ngFor="let markUp of markupList"
                [value]="markUp.value"
                >{{ markUp.label }}</option
              >
            </select>
          </td>
          <!-- <td>{{ rowData.tmAmount }}</td>
          <td>
            <input type="number" [(ngModel)]="rowData.flateRate" [disabled]="rowData.billingMethodId != 2"/>
          </td> -->
          <td>
              <input type="number" [(ngModel)]="rowData.billingRate" (change)="rowData.billingAmount = rowData.billingRate*rowData.quantity" [disabled]="isView || rowData.billingMethodId != 2"/>
          </td>
          <td>{{ rowData.billingAmount }}</td>
        </ng-container>
        <td *ngIf="!isView">
            <button
              class="btn-edit ptable-wo-btns"
              mat-icon-button
              data-target="#addNewCharges"
              data-toggle="modal"
              (click)="edit(rowData, i)"
              matTooltip="Edit"
            >
              <mat-icon>edit</mat-icon>
            </button>
          </td>
          <td *ngIf="!isView">
            <button
              class="btn-delete ptable-wo-btns"
              mat-icon-button
              matTooltip="Delete"
              (click)="delete(rowData, i)"
            >
              <mat-icon color="warn">delete</mat-icon>
            </button>
          </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="footer" *ngIf="isQuote">
      <tr>
        <td>Total</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>{{ getTotalQuantity() }}</td>
        <td>{{ getTotalUnitCost() }}</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>{{ getTotalBillingRate() }}</td>
        <td>{{ getTotalBillingAmount() }}</td>
        <td>&nbsp;</td>
        <td *ngIf="!isView">&nbsp;</td>
      </tr>
    </ng-template>
  </p-table>
  <button
    class="btn btn-primary pull-right"
    (click)="createChargeQuote()"
    *ngIf="!isView"
  >
    Save Charges
  </button>
</div>

<!-- <div class="equipment-tab-content">
  <div class="x_panel" *ngIf="workOrderChargesList">
    <div class="tab-content">
      <div
        class="table-responsive table-overflow"
        id="workflow-attributes-block"
      >
        <table class="table table-bordered ">
          <thead>
            <tr *ngIf="isQuote">
              <td colspan="8">&nbsp;</td>
              <td colspan="3">
                  <div class="form-group">
                    <p-radioButton
                      class="p-radiobutton-label-horizontal"
                      name="costPlusType"
                      label="Mark Up"
                      value="Mark Up"
                      [(ngModel)]="costPlusType"
                      [disabled]="isView"
                    ></p-radioButton>
                    <p-radioButton
                      class="p-radiobutton-label-horizontal col-width"
                      name="costPlusType"
                      value="Cost Plus"
                      label="Cost Plus"
                      [(ngModel)]="costPlusType"
                      [disabled]="isView"
                    ></p-radioButton>
                  </div>
              </td>
              <td colspan="2" *ngIf="!isView">&nbsp;</td>
            </tr>
            <tr>
              <th class="text-center">Charge Type</th>
              <th class="text-center">Description</th>
              <th class="text-center">Quantity</th>
              <th class="text-center">Unit Cost</th>
              <th class="text-center">Extented Cost</th>
              <th class="text-center">Unit Price</th>
              <th class="text-center">Extended Price</th>
              <th class="text-center">vendorName</th>
              <ng-container *ngIf="isQuote">
                <th *ngIf="costPlusType == 'Mark Up'">MARKUP</th>
                <th>Cost plus amount</th>
                <th>Fixed Amount</th>
              </ng-container>
              <th colspan="4" class="text-center" *ngIf="!isView"></th>
            </tr>
          </thead>



          <tbody>
            <ng-container *ngFor="let w of workOrderChargesList; let i = index">
              <tr *ngIf="!w['isDeleted']">
                <td>{{ w.chargeType }}</td>
                <td>{{ w.description }}</td>
                <td>{{ w.quantity }}</td>
                <td>{{ w.unitCost }}</td>
                <td>{{ w.extendedCost }}</td>
                <td>{{ w.unitPrice }}</td>
                <td>{{ w.extendedPrice }}</td>
                <td>{{ w.vendorName }}</td>
                <ng-container *ngIf="isQuote">
                    <td *ngIf="costPlusType == 'Mark Up'">
                        <select class="form-control wf-pub-id" (change)="markupChanged(w)" [(ngModel)]="w.markupPercentageId" [disabled]="isView">
                          <option value="">Select</option>
                          <option *ngFor="let markUp of markupList" [value]="markUp.value">{{markUp.label}}</option>
                        </select>
                    </td>
                    <td *ngIf="costPlusType == 'Mark Up'">{{ w.chargesCostPlus }}</td>
                    <td *ngIf="costPlusType == 'Cost Plus'">
                      <input type="number" [(ngModel)]="w.chargesCostPlus" [disabled]="isView"/>
                    </td>
                    <td>{{ w.fixedAmount }}</td>
                </ng-container>
                <td *ngIf="!isView">
                  <button
                    class="btn-edit ptable-wo-btns"
                    mat-icon-button
                    data-target="#addNewCharges"
                    data-toggle="modal"
                    (click)="edit(w, i)"
                    matTooltip="Edit"
                  >
                    <mat-icon>edit</mat-icon>
                  </button>
                </td>
                <td *ngIf="!isView">
                  <button
                    class="btn-delete ptable-wo-btns"
                    mat-icon-button
                    matTooltip="Delete"
                    (click)="delete(w, i)"
                  >
                    <mat-icon color="warn">delete</mat-icon>
                  </button>
                </td>
              </tr>
            </ng-container>
          </tbody>
          <tfoot *ngIf="isQuote">
            <tr>
                <td>Total Charges</td>
                <td>&nbsp;</td>
                <td>{{getTotalQuantity()}}</td>
                <td>{{getTotalUnitCost()}}</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>{{getChargesCostPlus()}}</td>
                <td>{{getTotalFixedAmount()}}</td>
                <td *ngIf="!isView">&nbsp;</td>
            </tr>
          </tfoot>
        </table>
        <button class="btn btn-primary pull-right" (click)="createChargeQuote()" *ngIf="!isView">Save</button>
      </div>
    </div>
    <div class="clear"></div>
    <br />
    <br />
    <br />
    <br />
  </div>
</div> -->
